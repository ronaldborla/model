{"version":3,"file":"model.js","sources":["../src/model/config.ts","../src/model/utils.ts","../src/model/model.ts","../src/model/collection.ts","../src/model/type.ts","../src/model/key.ts","../src/model/schema.ts","../src/model/trait.ts","../src/model.ts"],"sourcesContent":["export const __ = '__private__';","import { __ } from './config';\n\n/**\n * Model utilities\n */\nclass Utils {\n\n\t/**\n\t * Undefined\n\t */\n\tpublic undefined: any;\n\n\t/**\n\t * The constructor\n\t */\n\tconstructor() {\n\t\tthis.undefined = (function(undefined) {\n\t\t\treturn undefined;\n\t\t})();\n\t}\n\n  /**\n   * To camel case\n   */\n  public camelCase(str: string) {\n    return str.replace(/[-_]+/g, ' ').replace(/(?:^\\w|[A-Z]|\\b\\w|[\\s-_]+)/g, function(match, index) {\n      if (+match === 0) {\n        return ''; // or if (/\\s+/.test(match)) for white spaces\n      }\n      return index === 0 ? match.toLowerCase() : match.toUpperCase();\n    });\n  }\n\n  /**\n   * Emit an event\n   */\n  public emit() {\n  \tlet utils = this;\n  \treturn function(name: string, args: any, source?: any) {\n\t\t\tif (utils.isUndefined(source)) {\n\t\t\t\tsource = this;\n\t\t\t}\n\t\t\tthis.fire(name, args, source);\n\t\t\tif (!utils.isUndefined(this[__].parent) && utils.isFunction(this[__].parent.emit)) {\n\t\t\t\tthis[__].parent.emit(name, args, source);\n\t\t\t}\n\t\t\tif (!utils.isUndefined(this[__].collection) && utils.isFunction(this[__].collection.emit)) {\n\t\t\t\tthis[__].collection.emit(name, args, source);\n\t\t\t}\n\t\t\treturn this;\n  \t};\n  }\n\n\t/**\n\t * Extend\n\t */\n\tpublic extend(left: object, right: object, ignore?: any) {\n    this.forEach(right, (value, name) => {\n    \tif (this.isUndefined(ignore) || ignore.indexOf(name) < 0) {\n      \tleft[name] = value;\n    \t}\n    });\n    return left;\n\t}\n\n\t/**\n\t * Fire an event\n\t */\n\tpublic fire() {\n\t\tlet utils = this;\n\t\treturn function(name: string, args: any, source?: any) {\n\t\t\tif (!utils.isUndefined((this[__].listeners || {})[name])) {\n\t\t\t\tlet e = { \n\t\t\t\t\tname: name,\n\t\t\t\t\tsource: utils.isUndefined(source) ? this : source\n\t\t\t\t};\n\t\t\t\targs = (args || []).slice();\n\t\t\t\targs.unshift(e);\n\t\t\t\t(this[__].listeners[name] || []).forEach((callback) => {\n\t\t\t\t\tcallback.apply(this, args || []);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t}\n\n\t/**\n\t * Flatten ignore\n\t */\n\tpublic flattenIgnore(ignore: any) {\n\t\tlet flattened = {\n\t\t\t__flattened: true\n\t\t};\n\t\tif (!this.isUndefined(ignore)) {\n\t\t\tlet child_keys = [];\n\t\t\t(ignore || []).forEach((attribute) => {\n\t\t\t\tlet pos = attribute.indexOf('.'),\n\t\t\t\t\t\tleft = (pos >= 0) ? attribute.substr(0, pos) : attribute,\n\t\t\t\t\t\tright = (pos >= 0) ? attribute.substr(pos + 1) : '';\n\t\t\t\tif (right) {\n\t\t\t\t\tif (this.isUndefined(flattened[left])) {\n\t\t\t\t\t\tflattened[left] = [];\n\t\t\t\t\t}\n\t\t\t\t\tif (flattened[left] !== true) {\n\t\t\t\t\t\tif (child_keys.indexOf(left) < 0) {\n\t\t\t\t\t\t\tchild_keys.push(left);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tflattened[left].push(right);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tflattened[left] = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tchild_keys.forEach((key) => {\n\t\t\t\tif (flattened[key] !== true) {\n\t\t\t\t\tflattened[key] = this.flattenIgnore(flattened[key]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn flattened;\n\t}\n\n\t/**\n\t * Foreach\n\t */\n\tpublic forEach(object: object, callback: any) {\n    for (let o in object) {\n      if (object.hasOwnProperty(o)) {\n        if (callback.apply(object, [object[o], o, object]) === false) {\n          return false;\n        }\n      }\n    }\n    return true;\n\t}\n\n\t/**\n\t * Inherit a protoype\n\t */\n\tpublic inherit(parent: any, child: any, ignore?: any) {\n    child.prototype = Object.create(parent.prototype);\n    child.prototype.constructor = child;\n    this.extend(child, parent, ignore);\n    return child;\n\t}\n\n\t/**\n\t * Is function\n\t */\n\tpublic isFunction(variable: any) {\n    return !!(variable && variable.constructor && variable.call && variable.apply);\n\t}\n\n\t/**\n\t * Is undefined\n\t */\n\tpublic isUndefined(variable: any) {\n\t\treturn variable === this.undefined;\n\t}\n\n\t/**\n\t * Listen to an event\n\t */\n\tpublic on() {\n\t\tlet utils = this;\n\t\treturn function(name: string, callback: any) {\n\t\t\tlet object = this;\n\t\t\tif (!utils.isFunction(callback)) {\n\t\t\t\tthrow new Error('Callback parameter must be a function');\n\t\t\t}\n\t\t\tif (utils.isUndefined(this[__].listeners)) {\n\t\t\t\tthis[__].listeners = {};\n\t\t\t}\n\t\t\tif (utils.isUndefined(this[__].listeners[name])) {\n\t\t\t\tthis[__].listeners[name] = [];\n\t\t\t\tthis[__].listeners[name].__index = 0;\n\t\t\t}\n\t\t\tlet id = callback.id = this[__].listeners[name].__index++;\n\t\t\tthis[__].listeners[name].push(callback);\n\t\t\treturn function() {\n\t\t\t\tlet index = -1,\n\t\t\t\t\t\tlength = object[__].listeners[name].length;\n\t\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\t\tif (object[__].listeners[name][i].id === id) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tobject[__].listeners[name].splice(index, 1);\n\t\t\t\t}\n\t\t\t\treturn object;\n\t\t\t};\n\t\t};\n\t}\n\n\t/**\n\t * Get unique\n\t */\n\tpublic unique(array: Array<any>, callback?: any) {\n\t\tlet has_callback = this.isFunction(callback),\n\t\t\t\tkeys = {},\n\t\t\t\tunique = [];\n\t\t(array || []).forEach((item, i, list) => {\n\t\t\tlet key = has_callback ? callback(item, i, list) : item;\n\t\t\tif (keys[key] !== true) {\n\t\t\t\tunique.push(item);\n\t\t\t\tkeys[key] = true\n\t\t\t}\n\t\t});\n\t\treturn unique;\n\t}\n}\n\n/**\n * Export instance\n */\nexport let utils = new Utils();","import { __ \t } from './config';\nimport { utils } from './utils';\n\n/**\n * The Model\n */\nexport class Model {\n\n\t/**\n\t * The Model constructor\n\t */\n\tconstructor() {\n\t\tthis[__] = {\n\t\t\tattributes: {},\n\t\t\tlisteners: {}\n\t\t};\n\t\tthis.constructor.schema.applyDefaults(this);\n\t}\n\n  /**\n   * Emit an event\n   */\n  public emit(name: string, args: any, source?: any) {\n\t\treturn utils.emit().apply(this, [name, args, source]);\n  }\n\n\t/**\n\t * Fire an event\n\t */\n\tpublic fire(name: string, args: any, source?: any) {\n\t\treturn utils.fire().apply(this, [name, args, source]);\n\t}\n\n\t/**\n\t * Load attributes\n\t */\n\tpublic load(data?: any) {\n\t\tutils.forEach(data || {}, (value, key) => {\n\t\t\tif (this.constructor.schema.hasKey(key) || this.constructor.schema.hasVirtual(key, 'set')) {\n\t\t\t\tthis[key] = value;\n\t\t\t}\n\t\t});\n\t\treturn this.fire('load');\n\t}\n\n\t/**\n\t * Listen to an event\n\t */\n\tpublic on(name: string, callback: any) {\n\t\treturn utils.on().apply(this, [name, callback]);\n\t}\n\n\t/**\n\t * To string\n\t */\n\tpublic toJSON(ignore?: any, replacer?: any, space?: number) {\n\t\treturn JSON.stringify(this.toObject(ignore), replacer, space);\n\t}\n\n\t/**\n\t * Convert to object\n\t */\n\tpublic toObject(ignore?: any) {\n\t\tlet object = {},\n\t\t\t\tschema = this.constructor.schema;\n\t\tif (!ignore || !ignore.__flattened) {\n\t\t\tignore = utils.flattenIgnore(ignore);\n\t\t}\n\t\tschema.all_keys.forEach((key) => {\n\t\t\tif (ignore[key.name] !== true) {\n\t\t\t\tlet value = this[key.name];\n\t\t\t\tif (value && utils.isFunction(value.toObject)) {\n\t\t\t\t\tvalue = value.toObject(ignore[key.name]);\n\t\t\t\t}\n\t\t\t\tif (!utils.isUndefined(value)) {\n\t\t\t\t\tobject[key.name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif ((schema.options.toObject || {}).virtuals === true) {\n\t\t\tschema.__virtuals_keys.forEach((key_name) => {\n\t\t\t\tif (ignore[key_name] !== true && (utils.isFunction(schema.virtuals[key_name].get) || utils.isFunction(schema.virtuals[key_name]))) {\n\t\t\t\t\tlet value = this[key_name];\n\t\t\t\t\tif (value && utils.isFunction(value.toObject)) {\n\t\t\t\t\t\tvalue = value.toObject(ignore[key_name]);\n\t\t\t\t\t}\n\t\t\t\t\tif (!utils.isUndefined(value)) {\n\t\t\t\t\t\tobject[key_name] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn object;\n\t}\n\n\t/**\n\t * To string\n\t */\n\tpublic toString() {\n\t\treturn this.toJSON();\n\t}\n}","import { __ \t } from './config';\nimport { Model } from './model';\nimport { utils } from './utils';\n\n/**\n * Model Collection\n */\nexport class Collection extends Array {\n\n\t/**\n\t * The Collection constructor\n\t */\n\tconstructor() {\n\t\tthis[__] = {\n\t\t\tattributes: {},\n\t\t\tlisteners: {}\n\t\t};\n\t\tthis.constructor.schema.applyDefaults(this);\n\t}\n\n\t/**\n\t * Cast a variable into this collection's constructor\n\t */\n\tprivate cast(variable: any) {\n\t\tlet item = this.type.cast(variable);\n\t\tif (item instanceof Model) {\n\t\t\titem[__].collection = this;\n\t\t}\n\t\treturn item;\n\t}\n\n\t/**\n\t * Collection model\n\t */\n\tpublic get model() {\n\t\treturn utils.model.models[this.constructor.__constructor] || Model;\n\t}\n\n\t/**\n\t * Type\n\t */\n\tpublic get type() {\n\t\treturn utils.model.types[this.constructor.__constructor || 'Model'];\n\t}\n\n\t/**\n\t * Concatenate arrays\n\t */\n\tpublic concat() {\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\tthis.push.apply(this, arguments[i]);\n\t\t}\n\t\treturn this;\n\t}\n\n  /**\n   * Emit an event\n   */\n  public emit(name: string, args: any, source?: any) {\n\t\treturn utils.emit().apply(this, [name, args, source]);\n  }\n\n  /**\n   * Override fill\n   */\n  public fill() {\n  \targuments[0] = this.cast(arguments[0]);\n  \treturn Array.prototype.fill.apply(this, arguments);\n  }\n\n\t/**\n\t * Fire an event\n\t */\n\tpublic fire(name: string, args: any, source?: any) {\n\t\treturn utils.fire().apply(this, [name, args, source]);\n\t}\n\n\t/**\n\t * Load\n\t */\n\tpublic load(items?: any) {\n\t\tthis.push.apply(this, items || []);\n\t\treturn this.fire('load');\n\t}\n\n\t/**\n\t * Listen to an event\n\t */\n\tpublic on(name: string, callback: any) {\n\t\treturn utils.on().apply(this, [name, callback]);\n\t}\n\n\t/**\n\t * Override push\n\t */\n\tpublic push() {\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\targuments[i] = this.cast(arguments[i]);\n\t\t}\n\t\treturn Array.prototype.push.apply(this, arguments);\n\t}\n\n\t/**\n\t * Override splice\n\t */\n\tpublic splice() {\n\t\tif (arguments.length > 2) {\n\t\t\tfor (let i = 2; i < arguments.length; i++) {\n\t\t\t\targuments[i] = this.cast(arguments[i]);\n\t\t\t}\n\t\t}\n\t\treturn Array.prototype.splice.apply(this, arguments);\n\t}\n\n\t/**\n\t * Convert to JSON\n\t */\n\tpublic toJSON(ignore?: any, replacer?: any, space?: number) {\n\t\treturn JSON.stringify(this.toObject(ignore), replacer, space);\n\t}\n\n\t/**\n\t * Convert to object\n\t */\n\tpublic toObject(ignore?: any) {\n\t\tif (!ignore || !ignore.__flattened) {\n\t\t\tignore = utils.flattenIgnore(ignore);\n\t\t}\n\t\treturn this.map((item) => {\n\t\t\treturn utils.isFunction(item.toObject) ? item.toObject(ignore) : item;\n\t\t});\n\t}\n\n\t/**\n\t * To string\n\t */\n\tpublic toString() {\n\t\treturn this.toJSON();\n\t}\n\n\t/**\n\t * Override unshift\n\t */\n\tpublic unshift() {\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\targuments[i] = this.cast(arguments[i]);\n\t\t}\n\t\treturn Array.prototype.unshift.apply(this, arguments);\n\t}\n}","import { utils } from './utils';\n\n/**\n * Key Type\n */\nexport class Type {\n\n\t/**\n\t * The name\n\t */\n\tpublic name: string = null;\n\n\t/**\n\t * Safe name\n\t */\n\tpublic safe: string = null;\n\n\t/**\n\t * The constructor\n\t */\n\tprivate __constructor: any = null;\n\n\t/**\n\t * Type constructor\n\t */\n\tconstructor(name: string, constructor: any) {\n\t\tthis.name = name + '';\n\t\tthis.safe = this.name.toLowerCase();\n\t\tconstructor.type = this;\n\t\tthis.__constructor = constructor;\n\t\tthis.has_compare = utils.isFunction(this.__constructor.prototype.compare);\n\t}\n\n\t/**\n\t * Cast a variable into this type\n\t */\n\tpublic cast(variable: any, options?: any) {\n\t\tif (!this.is(variable)) {\n\t\t\tvariable = utils.isUndefined(options) ?\n\t\t\t\tnew this.__constructor(variable) :\n\t\t\t\tnew this.__constructor(variable, options);\n\t\t}\n\t\treturn variable;\n\t}\n\n\t/**\n\t * Compare\n\t */\n\tpublic compare(a: any, b: any) {\n\t\tif (this.has_compare) {\n\t\t\treturn a.compare(b);\n\t\t}\n\t\tif (a > b) {\n\t\t\treturn 1;\n\t\t} else if (b > a) {\n\t\t\treturn -1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/**\n\t * Check if variable is an instance of this type\n\t */\n\tpublic is(variable: any) {\n\t\treturn ((typeof variable).toLowerCase() === this.safe) || (variable && (variable instanceof this.__constructor));\n\t}\n\n\t/**\n\t * Check if constructor matches\n\t */\n\tpublic match(constructor: any) {\n\t\treturn constructor === this.__constructor;\n\t}\n}","import { __ \t\t\t\t} from './config';\nimport { Collection } from './collection';\nimport { Model  \t\t} from './model';\nimport { Schema \t\t} from './schema';\nimport { Type\t\t\t\t} from './type';\nimport { utils \t\t\t} from './utils';\n\n/**\n * Model Key class\n */\nexport class Key {\n\n\t/**\n\t * Type\n\t */\n\tpublic static Type: any = Type;\n\n\t/**\n\t * Default value\n\t */\n\tpublic default: any = utils.undefined;\n\n\t/**\n\t * Key name\n\t */\n\tpublic name: string = null;\n\n\t/**\n\t * Key options\n\t */\n\tpublic options: any = utils.undefined;\n\n\t/**\n\t * The schema\n\t */\n\tpublic schema: Schema = null;\n\n\t/**\n\t * The type\n\t */\n\tpublic type: Type = null;\n\n\t/**\n\t * Booted\n\t */\n\tprivate booted: boolean = false;\n\n\t/**\n\t * Key constructor\n\t */\n\tconstructor(schema: Schema, name: string, key: any) {\n\t\tthis.schema = schema;\n\t\tthis.name = name;\n\t\tthis.default = key.default;\n\t\tthis.options = key.options;\n\t\tthis.type = key.type || key;\n\t}\n\n\t/**\n\t * Boot key\n\t */\n\tpublic boot() {\n\t\tif (this.booted) {\n\t\t\treturn this;\n\t\t}\n\t\tlet key = this,\n\t\t\t\tname = this.name,\n\t\t\t\tschema = this.schema;\n\t\t// Fix type\n\t\tif (!(this.type instanceof Type)) {\n\t\t\tthis.type = schema.model.type(this.type);\n\t\t}\n\t\t// Define attribute\n\t\tObject.defineProperty(schema.__constructor.prototype, name, {\n\t\t\tget: function() {\n\t\t\t\treturn callMutator.apply(this, ['get', this[__].attributes[name]]);\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tlet previous = this[__].attributes[name];\n\t\t\t\tvalue = setParent(key.type.cast(value, key.options), this);\n\t\t\t\tthis[__].attributes[name] = value = callMutator.apply(this, ['set', value]);\n\t\t\t\treturn this.fire('setAttribute', [name, value, previous]);\n\t\t\t}\n\t\t});\n\t\tthis.booted = true;\n\t\treturn this;\n\n\t\t/**\n\t\t * Call mutator\n\t\t */\n\t\tfunction callMutator(method: string, value: any) {\n\t\t\tlet mutator = schema.cache.mutators[method][name];\n\t\t\tif (utils.isUndefined(mutator)) {\n\t\t\t\tlet fn = utils.camelCase([method, name, 'attribute'].join(' '));\n\t\t\t\tmutator = \n\t\t\t\t\tschema.cache.mutators[method][name] =\n\t\t\t\t\tutils.isFunction(this[fn]) ? fn : null;\n\t\t\t}\n\t\t\tif (mutator !== null) {\n\t\t\t\tvalue = this[mutator].apply(this, [value]);\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\t/**\n\t\t * Set Model or Collection parent\n\t\t */\n\t\tfunction setParent(value, model) {\n\t\t\tif (value && ((value instanceof Model) || (value instanceof Collection))) {\n\t\t\t\tvalue[__].parent = model;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\t}\n}","import { __  \t \t\t\t} from './config';\nimport { Collection } from './collection';\nimport { Key \t \t\t\t} from './key';\nimport { Model \t\t\t} from './model';\nimport { ModelJS \t\t} from '../model'\nimport { Trait \t\t\t} from './trait';\nimport { utils \t\t\t} from './utils';\n\n/**\n * The Model Schema class\n */\nexport class Schema {\n\n\t/**\n\t * The Key\n\t */\n\tpublic static Key: any = Key;\n\n\t/**\n\t * The keys\n\t */\n\tpublic keys: Array<Key> = [];\n\n\t/**\n\t * Methods\n\t */\n\tpublic methods: object = {};\n\n\t/**\n\t * Statics\n\t */\n\tpublic statics: object = {};\n\n\t/**\n\t * Virtuals\n\t */\n\tpublic virtuals: object = {};\n\n\t/**\n\t * The constructor\n\t */\n\tprivate __constructor: any;\n\n\t/**\n\t * Booted up\n\t */\n\tprivate booted: boolean = false;\n\n\t/**\n\t * ModelJS\n\t */\n\tprivate model: ModelJS = null;\n\n\t/**\n\t * Options\n\t */\n\tprivate options: object = {};\n\n\t/**\n\t * Schema type\n\t */\n\tprivate type: string = 'model';\n\n\t/**\n\t * Cache\n\t */\n\tprivate cache: object = {\n\t\tmutators: {\n\t\t\tget: {},\n\t\t\tset: {}\n\t\t}\n\t};\n\n\t/**\n\t * Schema constructor\n\t */\n\tconstructor(constructor: any, keys?: object, options?: object) {\n\t\tconstructor.schema = this;\n\t\tthis.__constructor = constructor;\n\t\tthis.options = options || {};\n\t\tif (!utils.isUndefined(keys) && keys) {\n\t\t\tlet index = 0;\n\t\t\tthis.keys.__index = {};\n\t\t\tutils.forEach(keys, (key, name) => {\n\t\t\t\tlet key_instance = new Key(this, name, key);\n\t\t\t\tthis.keys.__index[key_instance.name] = index++;\n\t\t\t\tthis.keys.push(key_instance);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * All keys\n\t */\n\tpublic get all_keys() {\n\t\tif (!utils.isUndefined(this.__keys)) {\n\t\t\treturn this.__keys;\n\t\t}\n\t\tthis.__keys = [];\n\t\tthis.__keys.__index = {};\n\t\tthis.inherited_keys.forEach((key) => {\n\t\t\tthis.__keys.__index[key.name] = this.__keys.length;\n\t\t\tthis.__keys.push(key);\n\t\t});\n\t\tthis.keys.forEach((key) => {\n\t\t\tif (utils.isUndefined(this.__keys.__index[key.name])) {\n\t\t\t\tthis.__keys.__index[key.name] = this.__keys.length;\n\t\t\t\tthis.__keys.push(key);\n\t\t\t}\n\t\t});\n\t\treturn this.__keys;\n\t}\n\n\t/**\n\t * All methods\n\t */\n\tpublic get all_methods() {\n\t\treturn utils.unique(Object.keys(this.methods).concat(this.inherited_methods));\n\t}\n\n\t/**\n\t * All statics\n\t */\n\tpublic get all_statics() {\n\t\treturn utils.unique(Object.keys(this.statics).concat(this.inherited_statics));\n\t}\n\n\t/**\n\t * All virtuals\n\t */\n\tpublic get all_virtuals() {\n\t\treturn utils.unique(Object.keys(this.virtuals).concat(this.inherited_virtuals));\n\t}\n\n\t/**\n\t * Base constructor\n\t */\n\tpublic get base_constructor() {\n\t\tswitch (this.type) {\n\t\t\tcase 'collection':\n\t\t\t\treturn Collection;\n\t\t\tcase 'model':\n\t\t\t\treturn Model;\n\t\t}\n\t\treturn utils.undefined;\n\t}\n\n\t/**\n\t * Constructors\n\t */\n\tpublic get constructors() {\n\t\treturn this.model.schemas[this.type + 's'];\n\t}\n\n\t/**\n\t * Inherited keys\n\t */\n\tpublic get inherited_keys() {\n\t\tlet parent = this.parent || {},\n\t\t\t\tparent_keys = parent.keys || [],\n\t\t\t\tkeys = [];\n\t\t(parent.inherited_keys || []).forEach((key) => {\n\t\t\tif (utils.isUndefined(parent_keys.__index[key.name])) {\n\t\t\t\tkeys.push(key);\n\t\t\t}\n\t\t});\n\t\treturn keys.concat(parent_keys);\n\t}\n\n\t/**\n\t * Get inherited methods\n\t */\n\tpublic get inherited_methods() {\n\t\treturn this.getInherited('methods');\n\t}\n\n\t/**\n\t * Get inherited statics\n\t */\n\tpublic get inherited_statics() {\n\t\treturn this.getInherited('statics');\n\t}\n\n\t/**\n\t * Get inherited virtuals\n\t */\n\tpublic get inherited_virtuals() {\n\t\treturn this.getInherited('virtuals');\n\t}\n\n\t/**\n\t * Get parent schema\n\t */\n\tpublic get parent() {\n\t\treturn (this.__constructor.inherits || {}).schema;\n\t}\n\n\t/**\n\t * All traits\n\t */\n\tpublic get traits() : Array<Trait> {\n\t\treturn (this.options.traits || []).map((trait) => {\n\t\t\treturn this.model.trait(trait);\n\t\t});\n\t}\n\n\t/**\n\t * Apply defaults\n\t */\n\tpublic applyDefaults(object) {\n\t\tthis.all_keys.forEach((key) => {\n\t\t\tif (!utils.isUndefined(key.default)) {\n\t\t\t\tif (utils.isFunction(key.default)) {\n\t\t\t\t\tobject[key.name] = key.default.apply(object, [key]);\n\t\t\t\t} else {\n\t\t\t\t\tobject[key.name] = key.default;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn object;\n\t}\n\n\t/**\n\t * Boot schema\n\t */\n\tpublic boot() {\n\t\tif (this.booted) {\n\t\t\treturn this;\n\t\t}\n\t\tif (utils.isUndefined(this.__constructor.inherits)) {\n\t\t\tthis.__constructor.inherits = this.base_constructor;\n\t\t\tif (utils.isUndefined(this.__constructor.inherits)) {\n\t\t\t\tthrow new Error('Invalid schema type: ' + this.type);\n\t\t\t}\n\t\t}\n\t\tif (!utils.isFunction(this.__constructor.inherits)) {\n\t\t\tlet parent = this.constructors[this.__constructor.inherits];\n\t\t\tif (utils.isUndefined(parent)) {\n\t\t\t\tthrow new Error('Invalid schema type: ' + this.type);\n\t\t\t}\n\t\t\tthis.__constructor.inherits = (parent instanceof Schema) ? parent.boot().__constructor : parent;\n\t\t}\n\t\tutils.inherit(this.__constructor.inherits, this.__constructor, [\n\t\t\t'__constructor',\n\t\t\t'__name',\n\t\t\t'inherits',\n\t\t\t'schema',\n\t\t\t'type'\n\t\t]);\n\t\tlet methods = {},\n\t\t\t\tstatics = {},\n\t\t\t\tvirtuals = {};\n\t\tthis.traits.forEach((trait) => {\n\t\t\tutils.extend(methods, trait.methods);\n\t\t\tutils.extend(statics, trait.statics);\n\t\t\tutils.extend(virtuals, trait.virtuals);\n\t\t});\n\t\tutils.forEach(methods, (value, key) => {\n\t\t\tif (utils.isUndefined(this.methods[key])) {\n\t\t\t\tthis.methods[key] = value;\n\t\t\t}\n\t\t});\n\t\tutils.forEach(statics, (value, key) => {\n\t\t\tif (utils.isUndefined(this.statics[key])) {\n\t\t\t\tthis.statics[key] = value;\n\t\t\t}\n\t\t});\n\t\tutils.forEach(virtuals, (value, key) => {\n\t\t\tif (utils.isUndefined(this.virtuals[key])) {\n\t\t\t\tthis.virtuals[key] = value;\n\t\t\t}\n\t\t});\n\t\tutils.forEach(this.methods, (value, key, object) => {\n\t\t\tif (utils.isFunction(value)) {\n\t\t\t\tthis.__constructor.prototype[key] = value;\n\t\t\t}\n\t\t});\n\t\tutils.forEach(this.statics, (value, key, object) => {\n\t\t\tthis.__constructor[key] = value;\n\t\t});\n\t\tthis.__virtuals_keys = [];\n\t\tutils.forEach(this.virtuals, (virtual, key) => {\n\t\t\tlet definition: any = {};\n\t\t\tif (utils.isFunction(virtual)) {\n\t\t\t\tdefinition.get = virtual;\n\t\t\t} else {\n\t\t\t\tif (!virtual) {\n\t\t\t\t\tvirtual = {};\n\t\t\t\t}\n\t\t\t\tif (utils.isFunction(virtual.get)) {\n\t\t\t\t\tdefinition.get = virtual.get;\n\t\t\t\t}\n\t\t\t\tif (utils.isFunction(virtual.set)) {\n\t\t\t\t\tdefinition.set = virtual.set;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (utils.isFunction(definition.get) || utils.isFunction(definition.set)) {\n\t\t\t\tObject.defineProperty(this.__constructor.prototype, key, definition);\n\t\t\t}\n\t\t\tthis.__virtuals_keys.push(key);\n\t\t});\n\t\tthis.booted = true;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Define a model\n\t */\n\tpublic define(modeljs: any, name: string, type?: string, model?: string) {\n\t\tthis.__constructor.__name = name;\n\t\tthis.model = modeljs;\n\t\tif (!utils.isUndefined(type)) {\n\t\t\tthis.type = type;\n\t\t}\n\t\tif (this.type === 'collection') {\n\t\t\tthis.__constructor.__constructor = model || 'Model';\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Get inherited\n\t */\n\tpublic getInherited(type) : Array<string> {\n\t\tlet parent = this.parent;\n\t\tif (!parent) {\n\t\t\treturn [];\n\t\t}\n\t\tlet parent_items = Object.keys(parent[type]) || [],\n\t\t\t\titems = [];\n\t\t(parent.getInherited(type) || []).forEach((item) => {\n\t\t\tif (utils.isUndefined(parent[type][item])) {\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t});\n\t\treturn items.concat(parent_items);\n\t}\n\n\t/**\n\t * Has key\n\t */\n\tpublic hasKey(name: string) {\n\t\treturn !utils.isUndefined(this.getKey(name));\n\t}\n\n\t/**\n\t * Has virtual\n\t */\n\tpublic hasVirtual(name: string, method?: string = 'get') {\n\t\tif (method === 'get') {\n\t\t\treturn utils.isFunction(this.virtuals[name]) || utils.isFunction(this.virtuals[name].get);\n\t\t} else if (method === 'set') {\n\t\t\treturn !utils.isUndefined(this.virtuals[name]) && utils.isFunction(this.virtuals[name].set);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Inherit a parent constructor\n\t */\n\tpublic inherit(parent: any) {\n\t\tthis.__constructor.inherits = parent;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Get key\n\t */\n\tpublic getKey(name: string) {\n\t\treturn this.all_keys[this.all_keys.__index[name]];\n\t}\n\n\t/**\n\t * Setup a method\n\t */\n\tpublic method(name: string, callback: any) {\n\t\tthis.methods[name] = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Setup a static method\n\t */\n\tpublic static(name: string, callback: any) {\n\t\tthis.statics[name] = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Call super method\n\t */\n\tpublic super(object: any, name: string, args?: any) {\n\t\tif (name === 'constructor') {\n\t\t\treturn this.__constructor.inherits.apply(object, args || []);\n\t\t} else {\n\t\t\treturn this.__constructor.inherits.prototype[name].apply(object, args || []);\n\t\t}\n\t}\n\n\t/**\n\t * Use a trait\n\t */\n\tpublic use(traits: any) {\n\t\tif (utils.isUndefined(traits)) {\n\t\t\tthrow new Error('At least one `trait` is required');\n\t\t}\n\t\tif (utils.isUndefined(this.options.traits)) {\n\t\t\tthis.options.traits = [];\n\t\t}\n\t\tif (!utils.isFunction(traits.forEach)) {\n\t\t\ttraits = [traits];\n\t\t}\n\t\ttraits.forEach((trait) => {\n\t\t\tthis.options.traits.push(trait);\n\t\t});\n\t\treturn this;\n\t}\n\n\t/**\n\t * Setup a virtual method\n\t */\n\tpublic virtual(name: string, callback: any, method?: string = 'get') {\n\t\tif (method !== 'get' && method !== 'set') {\n\t\t\tthrow new Error('Invalid virtual method: ' + method);\n\t\t}\n\t\tif (utils.isUndefined(this.virtuals[name])) {\n\t\t\tthis.virtuals[name] = {};\n\t\t} else if (utils.isFunction(this.virtuals[name])) {\n\t\t\tthis.virtuals[name] = {\n\t\t\t\tget: this.virtuals[name]\n\t\t\t};\n\t\t}\n\t\tthis.virtuals[name][method] = callback;\n\t\treturn this;\n\t}\n}","import { Schema } from './schema';\nimport { utils \t} from './utils';\n\n/**\n * Trait\n */\nexport class Trait {\n\n\t/**\n\t * Trait name\n\t */\n\tpublic name: string = '';\n\n\t/**\n\t * Methods\n\t */\n\tpublic methods: object = {};\n\n\t/**\n\t * Statics\n\t */\n\tpublic statics: object = {};\n\n\t/**\n\t * Virtuals\n\t */\n\tpublic virtuals: object = {};\n\n\t/**\n\t * Trait constructor\n\t */\n\tconstructor() {\n\t\t// Do nothing\n\t}\n\n\t/**\n\t * Method\n\t */\n\tpublic method() {\n\t\treturn Schema.prototype.method.apply(this, arguments);\n\t}\n\n\t/**\n\t * Static\n\t */\n\tpublic static() {\n\t\treturn Schema.prototype.static.apply(this, arguments);\n\t}\n\n\t/**\n\t * Virtual\n\t */\n\tpublic virtual() {\n\t\treturn Schema.prototype.virtual.apply(this, arguments);\n\t}\n}","import { Collection } from './model/collection';\nimport { Model \t\t\t} from './model/model';\nimport { Schema \t\t} from './model/schema';\nimport { Trait \t\t\t} from './model/trait';\nimport { Type \t\t\t} from './model/type';\nimport { utils  \t\t} from './model/utils';\n\n/**\n * The ModelJS class\n */\nexport class ModelJS {\n\n\t/**\n\t * The Collection\n\t */\n\tpublic Collection: any = Collection;\n\n\t/**\n\t * The Model\n\t */\n\tpublic Model: any = Model;\n\n\t/**\n\t * Set Schema so that it can be accessible by modeljs.Schema\n\t */\n\tpublic Schema: any = Schema;\n\n\t/**\n\t * Trait\n\t */\n\tpublic Trait: any = Trait;\n\n\t/**\n\t * Traits\n\t */\n\tpublic traits: object = {};\n\n\t/**\n\t * Types\n\t */\n\tpublic types: object = {};\n\n\t/**\n\t * The utilities\n\t */\n\tpublic utils: any = utils;\n\n\t/**\n\t * Booted\n\t */\n\tprivate booted: boolean = false;\n\n\t/**\n\t * Collections\n\t */\n\tprivate collections: object = {};\n\n\t/**\n\t * Models\n\t */\n\tprivate models: object = {};\n\n\t/**\n\t * Schemas\n\t */\n\tprivate schemas: object = {\n\t\tcollections: {},\n\t\tmodels: {}\n\t};\n\n\t/**\n\t * Model constructor\n\t */\n\tconstructor() {\n\t\tutils.model = this;\n\t\tthis.schemas.collections.__keys = [];\n\t\tthis.schemas.models.__keys = [];\n\t\tthis.traits.__keys = [];\n\t\tthis.traits.__length = 0;\n\t\tthis.types.__keys = [];\n\t\tthis.types.__length = 0;\n\t\t// Initial types are Javascript Native types\n    this.type('Array', Array);\n    this.type('Boolean', Boolean);\n    this.type('Date', Date);\n    this.type('Number', Number);\n    this.type('Object', Object);\n    this.type('String', String);\n    // Set Collection and Model\n    this.type('Model', Model);\n    this.type('Collection', Collection);\n\t}\n\n\t/**\n\t * Register\n\t */\n\tprivate register(type: string, name: string, schema?: any, inherit?: string, model?: string) {\n\t\tlet plural = type + 's';\n\t\tif (utils.isUndefined(schema)) {\n\t\t\tif (!this.booted) {\n\t\t\t\tthrow new Error('modeljs must be booted first');\n\t\t\t}\n\t\t\treturn this[plural][name];\n\t\t} else {\n\t\t\tif (!(schema instanceof Schema)) {\n\t\t\t\tthrow new Error('schema must be an instance of `Schema`');\n\t\t\t}\n\t\t\tthis.schemas[plural][name] = schema.define(this, name, type, model);\n\t\t\tthis.schemas[plural].__keys.push(name);\n\t\t\tif (!utils.isUndefined(inherit)) {\n\t\t\t\tthis.schemas[plural][name].inherit(inherit);\n\t\t\t}\n\t\t\treturn this.schemas[plural][name];\n\t\t}\n\t}\n\n\t/** \n\t * Boot up\n\t * Models need to be booted up so that the dependencies within schemas can be properly handled\n\t */\n\tpublic boot() {\n\t\tif (this.booted) {\n\t\t\treturn this;\n\t\t}\n\t\t// Boot models\n\t\tthis.schemas.models.__keys.forEach((name) => {\n\t\t\tif (!utils.isUndefined(this.models[name])) {\n\t\t\t\tthrow new Error('Model already exists: ' + name);\n\t\t\t}\n\t\t\tthis.models[name] = this.schemas.models[name].boot().__constructor;\n\t\t\tthis.type(name, this.models[name]);\n\t\t});\n\t\t// Boot collections\n\t\tthis.schemas.collections.__keys.forEach((name) => {\n\t\t\tif (!utils.isUndefined(this.collections[name])) {\n\t\t\t\tthrow new Error('Collection already exists: ' + name);\n\t\t\t}\n\t\t\tthis.collections[name] = this.schemas.collections[name].boot().__constructor;\n\t\t\tthis.type(name, this.collections[name]);\n\t\t})\n\t\t// Boot keys\n\t\tthis.schemas.models.__keys.forEach((name) => {\n\t\t\tthis.models[name].schema.keys.forEach((key) => {\n\t\t\t\tkey.boot();\n\t\t\t});\n\t\t});\n\t\tthis.booted = true;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Define a collection\n\t */\n\tpublic collection(name: string, schema?: any, model?: string, inherit?: string) {\n\t\treturn this.register('collection', name, schema, inherit, model);\n\t}\n\n\t/**\n\t * Register or retrieve a Model\n\t */\n\tpublic model(name: string, schema?: any, inherit?: string) {\n\t\treturn this.register('model', name, schema, inherit);\n\t}\n\n\t/**\n\t * Register or retrieve a trait\n\t */\n\tpublic trait(name: any, trait?: Trait) {\n\t\tif (utils.isUndefined(trait)) {\n\t\t\tif (utils.isUndefined(this.traits[name])) {\n\t\t\t\tthrow new Error('Trait `' + name + '` does not exist');\n\t\t\t}\n\t\t\treturn this.traits[name];\n\t\t} else {\n\t\t\tif (!utils.isUndefined(this.traits[name])) {\n\t\t\t\tthrow new Error('Trait `' + name + '`already exists');\n\t\t\t}\n\t\t\ttrait.name = name;\n\t\t\tthis.traits[name] = trait;\n\t\t\tthis.traits.__keys.push(name);\n\t\t\tthis.traits.__length++;\n\t\t\treturn this;\n\t\t}\n\t}\n\n\t/**\n\t * Register/retrieve type\n\t */\n\tpublic type(name: string, constructor?: any) {\n\t\tif (utils.isUndefined(constructor)) {\n\t\t\tif (utils.isFunction(name)) {\n\t\t\t\tfor (let i = 0; i < this.types.__length; i++) {\n\t\t\t\t\tlet type = this.types[this.types.__keys[i]];\n\t\t\t\t\tif (type.match(name)) {\n\t\t\t\t\t\treturn type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (utils.isUndefined(this.types[name])) {\n\t\t\t\tthrow new Error('Type `' + name + '` does not exist');\n\t\t\t}\n\t\t\treturn this.types[name];\n\t\t} else {\n\t\t\tif (!utils.isUndefined(this.types[name])) {\n\t\t\t\tthrow new Error('Type `' + name + '` already exists');\n\t\t\t}\n\t\t\tthis.types[name] = new Type(name, constructor);\n\t\t\tthis.types.__keys.push(name);\n\t\t\tthis.types.__length++;\n\t\t\treturn this;\n\t\t}\n\t}\n}\n\n/**\n * Export instance\n */\nexport let modeljs = new ModelJS();"],"names":[],"mappings":"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"}